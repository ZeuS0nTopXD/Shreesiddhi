<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="/logo_title.jpg">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shree Siddhi Ayur Wellness</title>
  <link rel="stylesheet" href="/appointment.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

  <!-- HEADER -->
  <header class="top-header">
    <div class="header-left">
      <img src="/logo.png" alt="Logo" class="logo">
      <div class="brand-title">
        <h1>SHREE SIDDHI AYUR</h1>
        <span>WELLNESS</span>
      </div>
    </div>
    <div class="header-right">
      <p class="dr-name">Dr. Suman Tiwari</p>
      <p class="dr-qual">(B.A.M.S. / D.D.H.N)<br>Physician & Dietician</p>
    </div>
  </header>

  <!-- NAVIGATION -->
  <nav class="navbar">
    <a href="/index.html">Home</a>
    <a href="/blog.html">Blog</a>
    <a href="/appointment.html" class="active">Appointment</a>
    <a href="/feedback.html">Feedback</a>
    <a href="/aboutus.html">About us</a>
  </nav>

  <!-- APPOINTMENT FORM -->
  <section class="appointment-section">
    <h2>Book an Appointment</h2>
    <p class="subtitle">Please fill out the form below to schedule</p>
    <div class="form-card">
      <form id="appointmentForm">
        <label>Full Name</label>
        <input type="text" name="name" required>

        <label>Email Address</label>
        <input type="email" name="email" required>

        <label>Phone Number</label>
        <input type="tel" name="phone" required pattern="[0-9]{10}" placeholder="10-digit number">

        <label>Preferred Date</label>
        <input type="date" name="date" required>

        <label>What would you like to book?</label>
        <select name="bookingType" id="bookingType" required>
          <option value="appointment" data-fee="500">Appointment — ₹500</option>
          <option value="followup" data-fee="200">Follow Up — ₹200</option>
        </select>

        <p id="feeDisplay" style="margin: 10px 0; font-weight: bold; color: #444;">Fee: ₹500</p>

        <label>Message</label>
        <textarea name="message"></textarea>

        <button type="submit" class="submit-btn">Proceed to Paytm Payment</button>
      </form>
    </div>
  </section>

  <!-- QUOTE -->
  <div class="quote">
    "In every herb, a cure; in every heart, a hope — that is Ayurveda."
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-section">
      <h4>Our Expertise</h4>
      <p>Shree Siddhi Ayur Wellness is dedicated to holistic healing through Ayurveda, yoga, and personalized diet care. Dr. Suman Tiwari offers compassionate care backed by years of experience.</p>
    </div>
    <div class="footer-section">
      <h4>Useful Links</h4>
      <a href="/index.html">Home</a>
      <a href="/blog.html">Blog</a>
      <a href="/appointment.html">Appointment</a>
      <a href="/feedback.html">Feedback</a>
      <a href="/aboutus.html">About us</a>
    </div>
    <div class="footer-section">
      <h4>Timing</h4>
      <p>Monday to Saturday: 11:00AM - 8:00PM</p>
      <p>Appointment Only on Prior Booking</p>
    </div>
    <div class="footer-section">
      <h4>Follow us</h4>
      <div class="social-icons">
        <a href="https://www.instagram.com/shreesiddhiwellness" target="_blank"><i class="fab fa-instagram"></i></a>
        <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook"></i></a>
        <a href="https://google.com" target="_blank"><i class="fab fa-google"></i></a>
        <a href="https://wa.me/1234567890" target="_blank"><i class="fab fa-whatsapp"></i></a>
        <a href="https://pinterest.com" target="_blank"><i class="fab fa-pinterest"></i></a>
        <a href="tel:+911234567890"><i class="fas fa-phone"></i></a>
      </div>
    </div>
  </footer>

  <div class="bottom-bar">
    <p>shrisiddhiayurwellness@gmail.com | © 2025 Shree Siddhi Ayur Wellness. All rights reserved.</p>
    <p><a href="#">Privacy Policy</a> | <a href="#">Terms & Conditions</a></p>
  </div>

  <!-- PAYTM SCRIPT -->
  <script>
    const bookingTypeSelect = document.getElementById("bookingType");
    const feeDisplay = document.getElementById("feeDisplay");
    const form = document.getElementById("appointmentForm");

    // Update fee dynamically
    bookingTypeSelect.addEventListener("change", () => {
      const fee = Number(bookingTypeSelect.selectedOptions[0].dataset.fee);
      feeDisplay.textContent = `Fee: ₹${fee}`;
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const submitBtn = e.target.querySelector(".submit-btn");
      submitBtn.disabled = true;
      submitBtn.textContent = "Processing...";

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      data.fee = Number(bookingTypeSelect.selectedOptions[0].dataset.fee);

      try {
        const res = await fetch("/api/paytm/order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            amount: data.fee,
            email: data.email,
            phone: data.phone,
            name: data.name
          })
        });

        const result = await res.json();
        if (!result.success) {
          alert(result.message || "Failed to create Paytm order.");
          submitBtn.disabled = false;
          submitBtn.textContent = "Proceed to Paytm Payment";
          return;
        }

        // Create form and submit to Paytm
        const paytmForm = document.createElement("form");
        paytmForm.method = "POST";
        paytmForm.action = result.data.paytmUrl;

        Object.entries(result.data.params).forEach(([k, v]) => {
          const input = document.createElement("input");
          input.type = "hidden";
          input.name = k;
          input.value = v;
          paytmForm.appendChild(input);
        });

        document.body.appendChild(paytmForm);
        paytmForm.submit();

      } catch (err) {
        console.error("Paytm order creation failed:", err);
        alert("An error occurred. Please try again.");
        submitBtn.disabled = false;
        submitBtn.textContent = "Proceed to Paytm Payment";
      }
    });
  </script>
</body>
</html>
